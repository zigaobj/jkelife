100810:用片上的SPI1与SPI2连接两片24L01，开始发送接收测试程序编写。
100814:调试通过，用查询方式在SPI2上接收SPI1上的24L01的数据，无误码。
100816:测试用中断方式接收数据，32字节可以，但修改字节后发现中断接收不了，估计设置问题
100819:中断方式接收成功，利用串口，添加了超时重发，发送错误重发等报告，如果设置接收32字节，则一定是接收32字节后IRQ脚才低电平中断。
100823:测试24L01的远距离穿墙能力。用STC51做接收。还要测试如果发送的字节不满接收字节数，或超过接收字节数的解决方案。不满接收数据长度的，
	   要补0x00之类填满，不然无法接收，特别是发送字节小于接收数据长度。
100829:按32字节发送数据，编写解释24L01接收数据函数SPI1Rx_Parse()，

100919:规定SPI1为TX，SPI2为RX
nRF24L01特性是发射要指定发射地址，接收有最多6个通过，可以设置不同的地址

100925:Data接收阶段分时切换Rx_P1~5
24L01的SPI接收数据解析函数加入区分接收通道的功能，但实际没用，SPI_Parse还是对整体接收的命令做解析，是发送主节点的命令作相应处理
如果是发给上位机的，直接立刻通过串口发送。

100930:修改TIM3的时基为64us，一个ping还是1秒

101024:用JK板组网发送命令成功，从模块发送组网命令至主模块，接收成功。但发送新组网地址至从模块未成功。

101108:24L01的IRQ脚接收一次后不能拉低
101109:将IRQ改为查询方式试验
101201:SPI2 接收组网改为1通道
101208:尝试错开接收组网与发送组网命令时间
110105:在SPI2接收函数中添加区分通道号的判断。
110124:从模块向主模块发送数据的地址与主模块向从模块发送数据的地址必须不同。接收与发送的同步字Synchron Word
110206: 先确认接收地址是否会自动过滤，进行点对点的通讯。CE需要低电平Si4431才能正常工作
110213:可以同块板子通讯了！
110217:两块板可以通讯了！
110219:可以单向连续通讯，SI4431接收模块收到错误引导码需要重新配置为接收模式，改为发射接收只用一个模块
110217:两块板可以通讯了！
110219:可以单向连续通讯，SI4431接收模块收到错误引导码需要重新配置为接收模式，改为发射接收只用一个模块
110223:平时从模块可以都处于接收状态，需要发送数据时才转为发送状态，重发需要程序判断。无论什么模块，只用32位地址表示
110225:遇到HardFault_Handler的问题，竟然是由于指针没初始化指向，指飞了。
110302:longword32类型的uion，可以知道STM32是小端模式，注意地址设置时的大小端问题。
准备调回复命令
110309:主从模块可以双向通讯！
110314:双向通讯成功，不过发送包需要定长，


100XXX:先不做跳频，只做载波监听，伪随机延时等待，频率固定为DEFAULT_FRE

整个自组网通信过程由以下几部分组成：
组网退网阶段，同步阶段 ，广播阶段，维持心跳普通数据接收阶段，大量数据点对点传输

1、组网退网阶段: 
由上位机命令控制开启关闭此状态，需要规定组网超时时间如10秒，命令为#AENCNT	停止组网#ADSCNT
组网期间，主模块不发送同步命令，从模块发送的心跳包不接收
主节点SPI2的RX_P0通道0启用，且接收地址RX_ADDR_P0设为组网地址NetConnectRxAdr，当监听到从模块组网命令后回复确认组网命令且发送从模块TX新地址(也是主模块RX通道新地址)
如果超时WaitConnectTime后，上位机发送停止组网命令，等待用户选择不需要连接的从模块，确认后向不需要组网的从模块发送断网命令。

组网过程SPI2的RX_P1~P5通道继续轮询接收已经组网的从模块心跳包

(暂不启用：没有收到组网命令则换频段继续监听，主从节点频道表要一致(10个频道)主模块换频段频率要慢于从模块，例如主模块换频道的时间的一半，从模块就把10个频道换一遍了，这样保证主模块每个频道都有可能与从模块频道同步一次当主模块收到组网命令后，)

从节点处于发送模式需要载波监听，如果发现信道占用需进行伪随机延时等待后再监听发送，(暂不启用跳频：若等待次数CDDelayNum大于CDDELAYMAX后换频道继续监听)
当发现信道空闲后发送组网命令#CNT,00000\r\n，如果收到ACK应答后，从模块转为接收模式，等待主模块发送确认组网命令及主模块的新通信地址
从模块如果收到断网命令，则继续之前的组网流程，直到超时NETCNTTIMEMAX，进入休眠模式监听接收唤醒命令WKU，省电，等待唤醒
组网过程还要加入识别是否本公司的产品。要算一串注册码狗号。

2、同步阶段：让主机和所有节点处于同一时钟频率下，(其实慢跳频不需要同步阶段)
如果在(4)阶段接收不到从模块的心跳包，超时后主模块不在给离网的从模块发送同步命令，从模块可以以此检测自己是否离网需要重新联网。

从节点不用回复，但需要收到命令后修正自己的时钟

3、广播阶段：向各从模块发送控制命令的阶段，命令里面还是需要带要发送至的从模块地址

4、数据接收；心跳包由从模块发送，主模块上P1-P5接收通道的地址与已组网的从模块地址相关，如果组网从模块数量大于5个则需要轮换P1-P5接收通道的地址
组网后在主模块上对应的的从模块接收通道地址命名规范 : (需要符合24L01规范)
主模块2 3 4 5字段地址 + 根据组网顺序添加的字段


5、点对点传输：用于大数据传输，双向的，
6、休眠模式：从模块将设为接收，并且接收通道设为一个休眠SLEEP_RXADR地址，等待另外的主模块组网唤醒。

发送接收过程：
一、成功发送接收的必备条件：
1、双方RF_CH工作通道频率要一致
2、接收方设置的接收通道数据长度与发送方发送的数据长度要一致
3、CRC位数一致，自动应答均开启
二、1对1发送接收
1、发射方的TX_ADDR发射地址，RX_ADDR_P0接收通道(也可以是P0-P5)要一致（用于应答ACK），
当然接收方的RX_ADDR_P0接收通道(也可以是P0-P5)也要与前面两者一致

抗干扰跳频载波侦听技术:
载波侦听与跳频有所选择，如果监听到有准备发送频道的电磁波在空气中，就选择等待一定时间，然后再跳频发送。
跳频需要根据伪随机跳频表进行，
信道监听，对发送出去的丢包进行统计，如果丢包严重，则需要换频段重新通讯，

心跳包：
从模块间隔一段时间(例如30秒)，向主控制发送心跳包，表示自己工作正常及网络通讯正常。主控制模块对心跳超时(例如3倍心跳间隔)进行判断，如果超时认为从模块断开。
心跳包数据包括从模块地址，电池电量等信息。

多点通信思路：(最好每个模块有收发独立的两路，且频率)
24L01最多可以设置6频道的接收地址实现1对6的发送，但如果想对更多地址模块发送数据，则要重新配置频道接收地址。
在做产品时，还要考虑每个模块的地址分配。
主发射控制模块一般只有一个，可以按每套产品设置，然后无线终端节点自己报地址，主发射模块过一段时间监听一下然后保存地址，
1、主控制设置为接收模式广播地址时，用于新组网及搜索新从模块，搜索模式时各主从模块随机的跳频(可选20个频道跳跃，为了避免同时有多个从设备连接主设备组网)，
   组网时，首先一段时间内从设备向广播地址发送组网握手命令及自己的设备号(唯一的，也是初始的发送接收地址)，如果收到ACK回复则从模块转为接收模式，但仍用原始接收地址(这里有超时机制，如果超时没收到确认组网则转为发送模式重新继续握手组网)。
   主控制根据自己的设备号+从设备号算出新的地址，然后主控制模块的操作界面可以选择是否组网所找到的设备(防止接收到不是本住宅区域的从模块)，
   (规定时间内进行，如果超时则回到主控制模式)如果确定组网则主模块转为发送模式，并向各从模块原始接收地址发送组网命令及新的地址，
   然后各模块自动转为接收模式，且启用新接收地址，并保持地址到flash中，主模块也需保持组网的从模块地址。
   组网结束后，主控制定时查询各从模块状态，是否连接成功及电量等属性。
2、主控制如果要真全双工工作，最好带两个模块，一个发射，一个接收。
3、作为发送方，一般发送地址与接收地址要设为一致，为了应答接收设备，接收通道0地址和发送地址相同
4、原始地址规则(4字段0xFF地址，共2^32个地址)
	
	第一字段：产品型号，0x00~0xff，初定主控模块是0x21，从模块(开关量)0x31，(智能学习型遥控)0x32，(温度湿度监控)0x33。
				   				   		 
	第二、三、四字段：产品编号，共2^24个地址，1677万个地址

	如果组网匹配成功，则从模块的新地址重新编号，例如主控制原始地址是0x21 0xA1 0x0A 0x12 0x45，
	不管从模块原始地址，则组网成功后，按从模块接入网络的顺序位置，例如是第五个接入的模块，启用新地址为0xA1 0x0A 0x12 0x45 0x05

//*********************RF Si4431命令体系**************************************************************
RF Si4431命令体系：
平时模块都是处于接收模式，当发送方发送数据后，需要等待接收方的回复命令，否则将重发此数据
接收方收到命令，进行回复，不需要等待原发送方的回复。

命令全部采用ASCII码，发送以'#'二进制0x23为开始，结束用0x0D 0x0A回车换行符标志。命令最长为256字节，超过则换下一帧发送
命令体如下：
"#命令名(6字节),源地址(8字节),目标地址(8字节),data(最长228字节)\r\n"
解析：
从模块发给主模块：
	1、新入网组网(Net Connect)命令"#NETCNT,源地址(8字节),目标地址(8字节)\r\n"
主模块发给从模块：
	1、确认组网成功(Net Apply)命令"#NETAPL,源地址(8字节),目标地址(8字节)\r\n"



	